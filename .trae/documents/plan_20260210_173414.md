Untuk menangani dokumen **multi-halaman** dan **banyak item**, kita perlu mengubah strategi dari "single page scan" menjadi "multi-page iteration".

Berikut adalah rencana teknisnya:

### 1. Strategi Multi-Halaman (PDF)
Alih-alih hanya mengambil halaman 1, sistem akan melakukan _looping_ ke seluruh halaman PDF:
1.  **Inisialisasi Worker Tesseract** satu kali di awal.
2.  **Looping Halaman**:
    *   Ambil halaman `i` dari PDF.
    *   Render ke Canvas (Image).
    *   Kirim ke Tesseract untuk OCR.
    *   Simpan teks hasil scan ke variabel penampung (`fullText`).
    *   Update progress bar (contoh: "Scanning Page 1 of 5...").
3.  Setelah semua halaman selesai, gabungkan teks dan matikan Worker.

### 2. Strategi Parsing (Banyak Item)
Dengan menggabungkan teks dari semua halaman, tantangannya adalah "sambungan" antar halaman (Header/Footer yang berulang).
*   **Logika Header (PO/Date)**:
    *   Perluas pencarian: Jangan hanya cari di 20 baris pertama, tapi cari di **seluruh halaman pertama** (atau buffer teks awal).
*   **Logika Total**:
    *   Cari dari baris paling bawah ke atas (karena Grand Total biasanya di halaman terakhir).
*   **Logika Tabel Item**:
    *   Logika `inTable` saat ini sudah cukup pintar: dia akan berhenti saat ketemu "Footer" (Subtotal/Tax).
    *   Jika tabel terpotong halaman baru dan ada Header lagi, parser akan mendeteksi ulang header tersebut dan melanjutkan mode tabel (`inTable = true`).
    *   Saya akan sesuaikan agar parser mengabaikan baris header tabel yang berulang di tengah-tengah data agar tidak dianggap sebagai item error.

### 3. Implementasi
Saya akan memecah kode menjadi fungsi-fungsi modular agar lebih rapi:
-   `runOcr(imageSource)`: Fungsi generik untuk OCR satu gambar.
-   `processPdf(file)`: Loop semua halaman -> panggil `runOcr` berulang -> gabung teks.
-   `processImage(file)`: Panggil `runOcr` sekali.
-   `parseAndFill(fullText)`: Update logika pencarian agar tidak terbatas 30 baris awal/akhir saja.

Apakah Anda setuju dengan pendekatan ini?